import { createContext, useContext, useEffect, useMemo, useState } from "react";

type Locale = "en" | "fr";
type MessageValue = string | Record<string, string>;
type Messages = Record<string, MessageValue>;

const STORAGE_KEY = "travel-optimizer-locale";
const FALLBACK_LOCALE: Locale = "en";

const MESSAGES: Record<Locale, Messages> = {
  en: {
    "action.cancelJob": "Cancel job",
    "action.clear": "Clear",
    "action.downloadCalendar": "Download calendar (.ics)",
    "action.downloadExcel": "Download Excel",
    "action.downloadJson": "Download JSON",
    "action.launchOptimization": "Launch optimization",
    "action.loadResults": "Load results",
    "action.refreshQueue": "Refresh queue",
    "action.removeItem": "Remove {item}",
    "action.resetFilters": "Reset filters",
    "action.runFlightInsights": "Run flight insights",
    "action.toggleTheme": "Toggle theme",
    "action.uploadJson": "Upload JSON",
    "action.useWindowForInsights": "Use this window for flight insights",
    "app.heroSubtitle":
      "Two distinct modules: a leave-based destination advisor and a date-range flight insights scanner.",
    "app.heroTitle": "Precision travel planning, distilled.",
    "app.name": "Travel Optimizer",
    "aria.filterHaul": "Filter by haul type",
    "aria.minRestDays": "Minimum rest days",
    "aria.searchDestinations": "Search destinations",
    "aria.sortResults": "Sort results",
    "calendar.base.closure": "closure",
    "calendar.base.holiday": "holiday",
    "calendar.base.weekend": "weekend",
    "calendar.base.work": "workday",
    "calendar.daysOfRest": {
      one: "{count} day of rest",
      other: "{count} days of rest"
    },
    "calendar.empty.description":
      "Run the optimizer to generate a day-by-day calendar with holidays and optimized leave.",
    "calendar.empty.title": "Calendar data missing",
    "calendar.hoverHint": "Hover a window on the calendar to preview destinations.",
    "calendar.ics.holiday": "Holiday",
    "calendar.ics.holidayNamed": "Holiday: {name}",
    "calendar.ics.optimizedLeave": "Optimized leave",
    "calendar.ics.restWindow": "Rest window",
    "calendar.ics.restWindowDesc": "Optimized rest window",
    "calendar.label.leave": "leave {leave}",
    "calendar.leave.cp": "paid leave",
    "calendar.leave.recup": "recup",
    "calendar.leave.rtt": "RTT",
    "calendar.leave.soft": "soft day",
    "calendar.noDestinations": "No destination suggestions for this window.",
    "calendar.noRestWindows": "No rest windows generated yet.",
    "calendar.restWindows": "Rest windows",
    "calendar.restWindowsHint": "Hover or click a window to reveal destination suggestions.",
    "calendar.stats.closures": {
      one: "{count} closure",
      other: "{count} closures"
    },
    "calendar.stats.holidays": {
      one: "{count} holiday",
      other: "{count} holidays"
    },
    "calendar.stats.optimizedLeave": {
      one: "{count} optimized leave day",
      other: "{count} optimized leave days"
    },
    "calendar.stats.weekendDays": {
      one: "{count} weekend day",
      other: "{count} weekend days"
    },
    "common.na": "--",
    "continent.africa": "Africa",
    "continent.antarctica": "Antarctica",
    "continent.asia": "Asia",
    "continent.europe": "Europe",
    "continent.north-america": "North America",
    "continent.oceania": "Oceania",
    "continent.other": "Other",
    "continent.south-america": "South America",
    "count.days": {
      one: "{count} day",
      other: "{count} days"
    },
    "count.destinations": {
      one: "{count} destination",
      other: "{count} destinations"
    },
    "count.flights": {
      one: "{count} flight",
      other: "{count} flights"
    },
    "count.itineraries": {
      one: "{count} itinerary",
      other: "{count} itineraries"
    },
    "count.jobs": {
      one: "{count} job",
      other: "{count} jobs"
    },
    "count.matches": {
      one: "{count} match",
      other: "{count} matches"
    },
    "count.options": {
      one: "{count} option",
      other: "{count} options"
    },
    "count.routes": {
      one: "{count} route",
      other: "{count} routes"
    },
    "empty.noDestinationsMatch": "No destinations match the filter.",
    "empty.noFlights": "No flight options available.",
    "empty.noInsightsDesc": "Run a scan to surface the best prices, fastest routes, and top scoring trips.",
    "empty.noInsightsTitle": "No insights yet",
    "empty.noItinerariesDesc": "Add more destination countries to expand the route builder.",
    "empty.noItinerariesTitle": "No itineraries yet",
    "empty.noItineraryPlans": "No itinerary plans available.",
    "empty.noJobsDesc": "Queue a flight insight scan to see progress and download results here.",
    "empty.noJobsTitle": "No jobs yet",
    "empty.noOptions": "No options available.",
    "empty.noResultsDesc":
      "Run the optimizer to generate results before exploring the calendar, map, and destinations.",
    "empty.noResultsTitle": "No results yet",
    "empty.pickDestinationsDesc": "Select at least one country and set a date window to build itineraries.",
    "empty.pickDestinationsTitle": "Pick destination countries",
    "error.apiOffline": "API is offline. Start the backend before running the optimizer.",
    "error.confirmLargeScan": "This scan includes {count} date combinations. Confirm to proceed.",
    "error.confirmRerun": "An identical scan is already running. Confirm to re-run anyway.",
    "error.invalidDepartureWindow": "Departure window start must be before the end date.",
    "error.invalidHomeCity": "Select a home city from the list or clear the field.",
    "error.invalidHomeCountryCode": "Selected country is missing a valid code.",
    "error.invalidInsightsOriginCity": "Select an origin city from the list or clear the field.",
    "error.invalidJson": "Invalid JSON file.",
    "error.invalidLeaveDays": "Leave days must be between 0 and 365.",
    "error.invalidMinRest": "Minimum rest window must be between 1 and 60 days.",
    "error.invalidReturnAfterDeparture": "Return window must start on or after the departure window.",
    "error.invalidReturnWindow": "Return window start must be before the end date.",
    "error.invalidYear": "Enter a valid year between 1900 and 2100.",
    "error.missingHomeCountry": "Select a country of residence before running the optimizer.",
    "error.missingInsightsDestinations": "Select at least one destination country.",
    "error.missingInsightsOriginCountry": "Select an origin country before running flight insights.",
    "error.missingLocationData": "Location data missing. Run `make map-data` to regenerate.",
    "error.missingPreferredDestinations": "Select at least one preferred city or country.",
    "error.unableCancelJob": "Unable to cancel job.",
    "error.unableFetchQueue": "Unable to fetch job queue.",
    "error.unableLoadJobResults": "Unable to load job results.",
    "error.unableQueueInsights": "Unable to queue flight insights.",
    "error.unableRunOptimizer": "Unable to run optimizer.",
    "field.countryResidence": "Country of residence",
    "field.haulTypes": "Haul types",
    "field.homeCity": "Home city",
    "field.leaveDays": "Leave days",
    "field.minRest": "Minimum rest window",
    "field.originCity": "Origin city",
    "field.originCountry": "Origin country",
    "field.preferredCities": "Preferred cities",
    "field.preferredCountries": "Preferred countries",
    "field.targetCountries": "Target countries",
    "field.year": "Year",
    "haul.long": "Long-haul (6-12h)",
    "haul.longLabel": "Long-haul",
    "haul.medium": "Medium-haul (3-6h)",
    "haul.mediumLabel": "Medium-haul",
    "haul.short": "Short-haul (<3h)",
    "haul.shortLabel": "Short-haul",
    "haul.ultra": "Ultra-long (12h+)",
    "haul.ultraLabel": "Ultra-long",
    "helper.fastMode": "Flight search can take several minutes; use insights when ready.",
    "helper.jobsBackground": "Jobs run in the background. Track progress in the queue tab.",
    "insights.card.bestPrices": "Best prices",
    "insights.card.fastestRoutes": "Fastest routes",
    "insights.card.fewestStops": "Fewest stops",
    "insights.card.topScores": "Top scores",
    "insights.summary": "{count} options - {origins}",
    "itinerary.category.chain.description": "Two-country chain (A\u2192B + B\u2192C = A\u2192C).",
    "itinerary.category.chain.label": "Chasles chain",
    "itinerary.category.direct.description": "Single-country loop. Origin \u2192 A \u2192 Origin.",
    "itinerary.category.direct.label": "Direct escape",
    "itinerary.category.loop.description": "Three-country loop with balanced stays.",
    "itinerary.category.loop.label": "Grand loop",
    "job.kind.flight-insights": "Flight insights",
    "job.status.cancelled": "Cancelled",
    "job.status.completed": "Completed",
    "job.status.failed": "Failed",
    "job.status.queued": "Queued",
    "job.status.running": "Running",
    "label.airports": "Airports",
    "label.autoCompiled": "Auto-compiled",
    "label.avgRain": "{precip}mm rain",
    "label.avgTemp": "{temp}C avg",
    "label.basedOnWindow": "Based on {range} window",
    "label.bestPrice": "Best price",
    "label.carrierUnknown": "Carrier: --",
    "label.carrierValue": "Carrier: {value}",
    "label.cities": "Cities",
    "label.confirmLargeScan": "I understand this scan covers {count} date combinations and may take longer.",
    "label.confirmRerun": "Re-run even though the same scan is currently running.",
    "label.daysRange": "{min}-{max} days",
    "label.departureWindow": "Departure window",
    "label.duration": "Duration",
    "label.fastMode": "Fast mode (skip flight search)",
    "label.fastest": "Fastest",
    "label.fewestStops": "Fewest stops",
    "label.flightHours": "~{hours}h flight",
    "label.flights": "Flights",
    "label.fromAirports": "From {codes}",
    "label.general": "General",
    "label.generalCoverage": "General coverage",
    "label.haulUnknown": "Haul not classified",
    "label.lodging": "Lodging",
    "label.notes": "Notes",
    "label.oneWay": "One-way",
    "label.origin": "Origin",
    "label.originShort": "origin",
    "label.other": "Other",
    "label.pending": "Pending",
    "label.pickDateRange": "Pick a date range.",
    "label.pickReturnRange": "Pick a return date range.",
    "label.price": "Price",
    "label.returnWindow": "Return window",
    "label.safety": "Safety: {level}",
    "label.scoreValue": "{score} score",
    "label.stops": "Stops",
    "label.stopsCount": {
      one: "{count} stop",
      other: "{count} stops"
    },
    "label.timesUnknown": "Times: --",
    "label.timesValue": "Times: {value}",
    "label.toAirports": "To {codes}",
    "label.topCount": "Top {count}",
    "label.topScore": "Top score",
    "label.totalDaysApprox": {
      one: "~{count} day",
      other: "~{count} days"
    },
    "label.travelDays": {
      one: "{count} travel day",
      other: "{count} travel days"
    },
    "label.tripDefault": "trip",
    "label.tripType.one-way": "one way",
    "label.tripType.round-trip": "round trip",
    "label.windowIndex": "Window {index}",
    "language.label": "Language",
    "legend.closure": "Closure",
    "legend.holiday": "Holiday",
    "legend.optimizedLeave": "Optimized leave",
    "legend.weekend": "Weekend",
    "map.bestPrice": "Best price",
    "map.bestRestWindows": "Best rest windows",
    "map.empty.description":
      "The map highlights origin hubs, destination clusters, and the most competitive routes based on price and duration.",
    "map.empty.noRoutes": "No routes to display yet.",
    "map.empty.prompt": "Click a route or airport on the map.",
    "map.error.missingAirports": "Airport data missing. Run `make map-data` to regenerate.",
    "map.flightOptions": "Flight options",
    "map.legend.destinations": "Destinations",
    "map.legend.origins": "Origins",
    "map.legend.routes": "Routes",
    "map.minDuration": "Min duration",
    "map.role": "Role",
    "map.role.destination": "Destination",
    "map.role.hub": "Hub",
    "map.role.origin": "Origin",
    "map.routes": "Routes",
    "map.selectedAirport": "Selected airport",
    "map.selectedRoute": "Selected route",
    "map.stops": "Stops",
    "map.title": "Route insights",
    "module.oneBadge": "Module 1",
    "module.oneDesc":
      "Inputs: year, leave days, home country/city, and minimum rest. Outputs: optimized calendar plus destination recommendations.",
    "module.oneTag": "Leave-based destinations",
    "module.oneTitle": "Advisor: optimized leave \u2192 countries & cities",
    "module.twoBadge": "Module 2",
    "module.twoDesc":
      "Inputs: origin country/city, destination countries, departure and return windows. Outputs: top 3 flights by price, duration, stops, and score.",
    "module.twoTag": "Date-range flight insights",
    "module.twoTitle": "Flight stats: depart/return windows \u2192 top results",
    "multiSelect.empty": "No matches",
    "multiSelect.emptySelection": "No selection yet.",
    "multiSelect.placeholder": "Search...",
    "nav.chooseModule": "Choose the right module",
    "nav.missionControl": "Mission control",
    "option.haul.all": "All hauls",
    "option.haul.long": "Long-haul",
    "option.haul.medium": "Medium-haul",
    "option.haul.short": "Short-haul",
    "option.haul.ultra": "Ultra-long",
    "option.sort.country": "Sort by country",
    "option.sort.flightHours": "Sort by flight hours",
    "option.sort.restAsc": "Sort by rest days (asc)",
    "option.sort.restDesc": "Sort by rest days",
    "picker.city.empty": "No cities found",
    "picker.city.emptyDisabled": "Select a country first",
    "picker.city.placeholder": "Select a home city",
    "picker.city.placeholderDisabled": "Select a country first",
    "picker.city.search": "Search cities",
    "picker.country.empty": "No countries found",
    "picker.country.placeholder": "Select a country",
    "picker.country.search": "Search countries",
    "picker.destinationCountries.empty": "No countries found",
    "picker.destinationCountries.emptyState": "No destination countries selected yet.",
    "picker.destinationCountries.placeholder": "Select destination countries",
    "picker.destinationCountries.search": "Search countries",
    "picker.destinationCountries.subtitle": "Search and select multiple countries.",
    "picker.destinationCountries.title": "Destination countries",
    "picker.homeCity.badge": "City",
    "picker.homeCity.subtitle": "Used to match nearby airports.",
    "picker.homeCity.title": "Home city",
    "picker.homeCountry.badge": "Residence",
    "picker.homeCountry.subtitle": "Sets the holiday calendar and home base.",
    "picker.homeCountry.title": "Country of residence",
    "picker.originCity.badge": "City",
    "picker.originCity.empty": "No cities found",
    "picker.originCity.emptyDisabled": "Select an origin country first",
    "picker.originCity.placeholder": "Select origin city",
    "picker.originCity.placeholderDisabled": "Select origin country first",
    "picker.originCity.search": "Search cities",
    "picker.originCity.subtitle": "Choose the city you depart from.",
    "picker.originCity.title": "Origin city",
    "picker.originCountry.badge": "Origin",
    "picker.originCountry.empty": "No countries found",
    "picker.originCountry.placeholder": "Select origin country",
    "picker.originCountry.search": "Search countries",
    "picker.originCountry.subtitle": "Pick where your trip starts.",
    "picker.originCountry.title": "Origin country",
    "picker.preferredCities.empty": "No cities found",
    "picker.preferredCities.emptyState": "No preferred cities selected yet.",
    "picker.preferredCities.placeholder": "Select preferred cities",
    "picker.preferredCities.search": "Search cities",
    "picker.preferredCities.subtitle": "Search and pin cities you want to prioritize.",
    "picker.preferredCities.title": "Preferred cities",
    "picker.preferredCountries.empty": "No countries found",
    "picker.preferredCountries.emptyState": "No preferred countries selected yet.",
    "picker.preferredCountries.placeholder": "Select preferred countries",
    "picker.preferredCountries.search": "Search countries",
    "picker.preferredCountries.subtitle": "Focus recommendations on these countries.",
    "picker.preferredCountries.title": "Preferred countries",
    "placeholder.minRestDays": "Min rest days",
    "placeholder.searchDestinations": "Search country, city, or IATA",
    "plan.dateCombinations": "Date combinations",
    "plan.departureDates": "Departure dates",
    "plan.description":
      "We scan every origin airport \u00d7 destination airport pair for each date combination. Results are cached to avoid duplicates and the scanner runs in parallel.",
    "plan.destinationCountries": "Destination countries",
    "plan.origin": "Origin",
    "plan.pairsCount": {
      one: "{count} pair",
      other: "{count} pairs"
    },
    "plan.returnDates": "Return dates",
    "plan.selectedCount": {
      one: "{count} selected",
      other: "{count} selected"
    },
    "queue.step.buildMatrix": "Build the full search matrix",
    "queue.step.cleanRank": "Clean + rank results",
    "queue.step.loadAirports": "Load airports for origin + destinations",
    "queue.step.scanFlights": "Scan flights in parallel + cache",
    "section.chaslesDesc":
      "Build multi-stop routes from your selected countries. Chasles relation keeps the chain coherent: A\u2192B + B\u2192C = A\u2192C.",
    "section.chaslesItineraries": "Chasles itineraries",
    "section.chaslesTitle": "Suggested routing chains",
    "section.curatedPlans": "Curated plans",
    "section.curatedPlansDesc": "Each itinerary bundles its matching destination and top travel options.",
    "section.destinationCountries": "Destination countries",
    "section.destinationFilters": "Destination filters",
    "section.destinationFiltersHelp": "Select at least one country or city to run module 1.",
    "section.destinations": "Destinations",
    "section.flightHighlights": "Flight highlights",
    "section.flightHighlightsDesc": "Best price, fastest route, and strongest scores across results.",
    "section.flightHighlightsTitle": "Best options at a glance",
    "section.flightInsights": "Flight insights",
    "section.flightJobs": "Flight jobs",
    "section.flights": "Flights",
    "section.itineraries": "Itineraries",
    "section.leaveSetup": "Leave setup",
    "section.leaveSetupDesc": "This module suggests destinations based on your leave days, year, and home location.",
    "section.networkView": "Network view",
    "section.optimizedCalendar": "Optimized calendar",
    "section.optimizedCalendarTitle": "See every holiday and optimized leave day",
    "section.originDates": "Origin and dates",
    "section.plannerHighlights": "Planner highlights",
    "section.progressQueue": "Progress and queue",
    "section.queueControl": "Queue control",
    "section.queueControlDesc": "Track background flight scans and download results when they complete.",
    "section.queueNext": "What happens next?",
    "section.queueNextDesc":
      "Start a flight insight scan, then monitor progress here. You can cancel a job at any time and rerun with different dates or countries.",
    "section.restPeriodMap": "Rest period map",
    "section.routesMap": "Routes map",
    "section.routesMapDesc": "Visualize the strongest routes and their rest windows.",
    "section.runInsights": "Run insights",
    "section.runInsightsDesc":
      "This module scans flights across your date windows and aggregates the best prices, fastest routes, and lowest stop counts.",
    "section.runOptimizer": "Run optimizer",
    "section.runOptimizerDesc":
      "The optimizer will compute the best leave windows and refresh destinations based on your filters.",
    "section.shortlistedPlaces": "Shortlisted places",
    "section.timeoffIntelligence": "Timeoff intelligence",
    "section.topFlightOptions": "Top flight options",
    "section.topFlightOptionsDesc": "Showing best ranked options across destinations.",
    "source.file": "File upload",
    "source.insightsHint": "Run a flight insights scan to populate this view.",
    "source.insightsLabel": "Insights",
    "source.latestScanReady": "Latest scan ready",
    "source.loadedLabel": "Loaded",
    "source.noJobsYet": "No jobs yet",
    "source.noScanYet": "No scan yet",
    "source.none": "No data loaded",
    "source.live": "Live API",
    "source.optimizerHint": "Run the optimizer to generate results.",
    "source.queueHint": "Run flight insights to queue a job.",
    "source.queueLabel": "Queue",
    "source.trackingJob": "Tracking job {id}",
    "stats.acrossWindows": {
      one: "Across {count} window",
      other: "Across {count} windows"
    },
    "stats.bestMonth": "Best month #{month} \u00b7 {efficiency} rest/CP",
    "stats.compositeRestIndex": "Composite rest index",
    "stats.currency": "Currency {currency}",
    "stats.departureWindow": "Departure window",
    "stats.destinationAirports": "Destination airports",
    "stats.destinations": "Destinations",
    "stats.flightOptions": {
      one: "{count} flight option",
      other: "{count} flight options"
    },
    "stats.optimizationScore": "Optimization score",
    "stats.originAirports": "Origin airports",
    "stats.paidLeaveUsed": "Paid leave used",
    "stats.restWindows": {
      one: "{count} rest window",
      other: "{count} rest windows"
    },
    "stats.returnWindow": "Return {start} - {end}",
    "stats.totalAirports": {
      one: "{count} total airport",
      other: "{count} total airports"
    },
    "stats.totalRestDays": "Total rest days",
    "stats.unusedLeave": {
      one: "{count} unused",
      other: "{count} unused"
    },
    "status.activeJobs": "Active jobs running",
    "status.api.checking": "API checking",
    "status.api.offline": "API offline",
    "status.api.online": "API online",
    "status.jobId": "Job ID {id}",
    "status.jobProgress": "Job progress",
    "status.lastRun": "Last run {time}",
    "status.lastScan": "Last scan {time}",
    "status.latestJobId": "Latest job ID {id}",
    "status.noActiveJobs": "No active jobs",
    "status.queueIdle": "Queue idle",
    "status.refreshing": "Refreshing...",
    "status.running": "Running...",
    "status.scanning": "Scanning...",
    "status.updated": "Updated {time}",
    "theme.dark": "Dark",
    "theme.label": "Theme",
    "theme.light": "Light",
    "tooltip.avgRain": "Avg precipitation: {precip}mm",
    "tooltip.avgRainMonths": "Avg precipitation ({months}): {precip}mm",
    "tooltip.avgTemp": "Avg temperature: {temp}C",
    "tooltip.avgTempMonths": "Avg temperature ({months}): {temp}C",
    "tooltip.safety": "Safety advisory"
  },
  fr: {
    "action.cancelJob": "Annuler la t\u00e2che",
    "action.clear": "Effacer",
    "action.downloadCalendar": "T\u00e9l\u00e9charger le calendrier (.ics)",
    "action.downloadExcel": "T\u00e9l\u00e9charger Excel",
    "action.downloadJson": "T\u00e9l\u00e9charger JSON",
    "action.launchOptimization": "Lancer l'optimisation",
    "action.loadResults": "Charger les r\u00e9sultats",
    "action.refreshQueue": "Rafra\u00eechir la file",
    "action.removeItem": "Retirer {item}",
    "action.resetFilters": "R\u00e9initialiser les filtres",
    "action.runFlightInsights": "Lancer les analyses de vols",
    "action.toggleTheme": "Basculer le th\u00e8me",
    "action.uploadJson": "Importer JSON",
    "action.useWindowForInsights": "Utiliser cette fen\u00eatre pour l'analyse des vols",
    "app.heroSubtitle":
      "Deux modules distincts : un conseiller de destinations bas\u00e9 sur les cong\u00e9s et un scanner d'analyses de vols par plage de dates.",
    "app.heroTitle": "Planification de voyage, distill\u00e9e.",
    "app.name": "Travel Optimizer",
    "aria.filterHaul": "Filtrer par type de vol",
    "aria.minRestDays": "Minimum de jours de repos",
    "aria.searchDestinations": "Rechercher des destinations",
    "aria.sortResults": "Trier les r\u00e9sultats",
    "calendar.base.closure": "fermeture",
    "calendar.base.holiday": "jour f\u00e9ri\u00e9",
    "calendar.base.weekend": "week-end",
    "calendar.base.work": "jour travaill\u00e9",
    "calendar.daysOfRest": {
      one: "{count} jour de repos",
      other: "{count} jours de repos"
    },
    "calendar.empty.description":
      "Lancez l'optimiseur pour g\u00e9n\u00e9rer un calendrier jour par jour avec jours f\u00e9ri\u00e9s et cong\u00e9s optimis\u00e9s.",
    "calendar.empty.title": "Donn\u00e9es de calendrier manquantes",
    "calendar.hoverHint": "Survolez une fen\u00eatre du calendrier pour pr\u00e9visualiser les destinations.",
    "calendar.ics.holiday": "Jour f\u00e9ri\u00e9",
    "calendar.ics.holidayNamed": "Jour f\u00e9ri\u00e9 : {name}",
    "calendar.ics.optimizedLeave": "Cong\u00e9 optimis\u00e9",
    "calendar.ics.restWindow": "Fen\u00eatre de repos",
    "calendar.ics.restWindowDesc": "Fen\u00eatre de repos optimis\u00e9e",
    "calendar.label.leave": "cong\u00e9 {leave}",
    "calendar.leave.cp": "cong\u00e9s pay\u00e9s",
    "calendar.leave.recup": "r\u00e9cup\u00e9ration",
    "calendar.leave.rtt": "RTT",
    "calendar.leave.soft": "jour souple",
    "calendar.noDestinations": "Aucune suggestion de destination pour cette fen\u00eatre.",
    "calendar.noRestWindows": "Aucune fen\u00eatre de repos g\u00e9n\u00e9r\u00e9e.",
    "calendar.restWindows": "Fen\u00eatres de repos",
    "calendar.restWindowsHint": "Survolez ou cliquez une fen\u00eatre pour voir les destinations sugg\u00e9r\u00e9es.",
    "calendar.stats.closures": {
      one: "{count} fermeture",
      other: "{count} fermetures"
    },
    "calendar.stats.holidays": {
      one: "{count} jour f\u00e9ri\u00e9",
      other: "{count} jours f\u00e9ri\u00e9s"
    },
    "calendar.stats.optimizedLeave": {
      one: "{count} cong\u00e9 optimis\u00e9",
      other: "{count} cong\u00e9s optimis\u00e9s"
    },
    "calendar.stats.weekendDays": {
      one: "{count} jour de week-end",
      other: "{count} jours de week-end"
    },
    "common.na": "--",
    "continent.africa": "Afrique",
    "continent.antarctica": "Antarctique",
    "continent.asia": "Asie",
    "continent.europe": "Europe",
    "continent.north-america": "Am\u00e9rique du Nord",
    "continent.oceania": "Oc\u00e9anie",
    "continent.other": "Autre",
    "continent.south-america": "Am\u00e9rique du Sud",
    "count.days": {
      one: "{count} jour",
      other: "{count} jours"
    },
    "count.destinations": {
      one: "{count} destination",
      other: "{count} destinations"
    },
    "count.flights": {
      one: "{count} vol",
      other: "{count} vols"
    },
    "count.itineraries": {
      one: "{count} itin\u00e9raire",
      other: "{count} itin\u00e9raires"
    },
    "count.jobs": {
      one: "{count} t\u00e2che",
      other: "{count} t\u00e2ches"
    },
    "count.matches": {
      one: "{count} r\u00e9sultat",
      other: "{count} r\u00e9sultats"
    },
    "count.options": {
      one: "{count} option",
      other: "{count} options"
    },
    "count.routes": {
      one: "{count} route",
      other: "{count} routes"
    },
    "empty.noDestinationsMatch": "Aucune destination ne correspond au filtre.",
    "empty.noFlights": "Aucune option de vol disponible.",
    "empty.noInsightsDesc":
      "Lancez un scan pour trouver les meilleurs prix, les trajets les plus rapides et les meilleurs scores.",
    "empty.noInsightsTitle": "Aucune analyse pour l'instant",
    "empty.noItinerariesDesc":
      "Ajoutez plus de pays de destination pour \u00e9largir le g\u00e9n\u00e9rateur d'itin\u00e9raires.",
    "empty.noItinerariesTitle": "Aucun itin\u00e9raire pour l'instant",
    "empty.noItineraryPlans": "Aucun plan d'itin\u00e9raire disponible.",
    "empty.noJobsDesc":
      "Lancez un scan d'analyse de vols pour suivre l'avancement et t\u00e9l\u00e9charger les r\u00e9sultats ici.",
    "empty.noJobsTitle": "Aucune t\u00e2che pour l'instant",
    "empty.noOptions": "Aucune option disponible.",
    "empty.noResultsDesc":
      "Lancez l'optimiseur pour g\u00e9n\u00e9rer des r\u00e9sultats avant d'explorer le calendrier, la carte et les destinations.",
    "empty.noResultsTitle": "Aucun r\u00e9sultat pour l'instant",
    "empty.pickDestinationsDesc":
      "S\u00e9lectionnez au moins un pays et une fen\u00eatre de dates pour g\u00e9n\u00e9rer des itin\u00e9raires.",
    "empty.pickDestinationsTitle": "S\u00e9lectionnez des pays de destination",
    "error.apiOffline": "L'API est hors ligne. Lancez le backend avant d'ex\u00e9cuter l'optimiseur.",
    "error.confirmLargeScan": "Ce scan inclut {count} combinaisons de dates. Confirmez pour continuer.",
    "error.confirmRerun": "Un scan identique est d\u00e9j\u00e0 en cours. Confirmez pour relancer.",
    "error.invalidDepartureWindow": "Le d\u00e9but de la fen\u00eatre de d\u00e9part doit pr\u00e9c\u00e9der la date de fin.",
    "error.invalidHomeCity": "S\u00e9lectionnez une ville de r\u00e9sidence dans la liste ou effacez le champ.",
    "error.invalidHomeCountryCode": "Le pays s\u00e9lectionn\u00e9 n'a pas de code valide.",
    "error.invalidInsightsOriginCity": "S\u00e9lectionnez une ville d'origine dans la liste ou effacez le champ.",
    "error.invalidJson": "Fichier JSON invalide.",
    "error.invalidLeaveDays": "Le nombre de jours de cong\u00e9 doit \u00eatre compris entre 0 et 365.",
    "error.invalidMinRest": "La fen\u00eatre de repos minimum doit \u00eatre comprise entre 1 et 60 jours.",
    "error.invalidReturnAfterDeparture":
      "La fen\u00eatre de retour doit commencer apr\u00e8s ou le m\u00eame jour que la fen\u00eatre de d\u00e9part.",
    "error.invalidReturnWindow": "Le d\u00e9but de la fen\u00eatre de retour doit pr\u00e9c\u00e9der la date de fin.",
    "error.invalidYear": "Entrez une ann\u00e9e valide entre 1900 et 2100.",
    "error.missingHomeCountry": "S\u00e9lectionnez un pays de r\u00e9sidence avant de lancer l'optimiseur.",
    "error.missingInsightsDestinations": "S\u00e9lectionnez au moins un pays de destination.",
    "error.missingInsightsOriginCountry": "S\u00e9lectionnez un pays d'origine avant de lancer l'analyse des vols.",
    "error.missingLocationData":
      "Donn\u00e9es de localisation manquantes. Lancez `make map-data` pour r\u00e9g\u00e9n\u00e9rer.",
    "error.missingPreferredDestinations": "S\u00e9lectionnez au moins un pays ou une ville pr\u00e9f\u00e9r\u00e9s.",
    "error.unableCancelJob": "Impossible d'annuler la t\u00e2che.",
    "error.unableFetchQueue": "Impossible de r\u00e9cup\u00e9rer la file.",
    "error.unableLoadJobResults": "Impossible de charger les r\u00e9sultats de la t\u00e2che.",
    "error.unableQueueInsights": "Impossible de lancer l'analyse des vols.",
    "error.unableRunOptimizer": "Impossible d'ex\u00e9cuter l'optimiseur.",
    "field.countryResidence": "Pays de r\u00e9sidence",
    "field.haulTypes": "Types de vol",
    "field.homeCity": "Ville de r\u00e9sidence",
    "field.leaveDays": "Jours de cong\u00e9",
    "field.minRest": "Fen\u00eatre de repos minimale",
    "field.originCity": "Ville d'origine",
    "field.originCountry": "Pays d'origine",
    "field.preferredCities": "Villes pr\u00e9f\u00e9r\u00e9es",
    "field.preferredCountries": "Pays pr\u00e9f\u00e9r\u00e9s",
    "field.targetCountries": "Pays cibles",
    "field.year": "Ann\u00e9e",
    "haul.long": "Long-courrier (6-12h)",
    "haul.longLabel": "Long-courrier",
    "haul.medium": "Moyen-courrier (3-6h)",
    "haul.mediumLabel": "Moyen-courrier",
    "haul.short": "Court-courrier (<3h)",
    "haul.shortLabel": "Court-courrier",
    "haul.ultra": "Tr\u00e8s long-courrier (12h+)",
    "haul.ultraLabel": "Tr\u00e8s long-courrier",
    "helper.fastMode":
      "La recherche de vols peut durer plusieurs minutes ; utilisez les analyses quand vous \u00eates pr\u00eat.",
    "helper.jobsBackground": "Les jobs tournent en arri\u00e8re-plan. Suivez la progression dans l'onglet file.",
    "insights.card.bestPrices": "Meilleurs prix",
    "insights.card.fastestRoutes": "Trajets les plus rapides",
    "insights.card.fewestStops": "Moins d'escales",
    "insights.card.topScores": "Meilleurs scores",
    "insights.summary": "{count} options - {origins}",
    "itinerary.category.chain.description": "Cha\u00eene de deux pays (A\u2192B + B\u2192C = A\u2192C).",
    "itinerary.category.chain.label": "Cha\u00eene de Chasles",
    "itinerary.category.direct.description": "Boucle sur un pays. Origine \u2192 A \u2192 Origine.",
    "itinerary.category.direct.label": "Evasion directe",
    "itinerary.category.loop.description": "Boucle de trois pays avec s\u00e9jours \u00e9quilibr\u00e9s.",
    "itinerary.category.loop.label": "Grande boucle",
    "job.kind.flight-insights": "Analyses de vols",
    "job.status.cancelled": "Annul\u00e9",
    "job.status.completed": "Termin\u00e9",
    "job.status.failed": "\u00c9chou\u00e9",
    "job.status.queued": "En attente",
    "job.status.running": "En cours",
    "label.airports": "A\u00e9roports",
    "label.autoCompiled": "Auto-compil\u00e9",
    "label.avgRain": "{precip}mm pluie",
    "label.avgTemp": "{temp}C moy.",
    "label.basedOnWindow": "Bas\u00e9 sur la fen\u00eatre {range}",
    "label.bestPrice": "Meilleur prix",
    "label.carrierUnknown": "Compagnie : --",
    "label.carrierValue": "Compagnie : {value}",
    "label.cities": "Villes",
    "label.confirmLargeScan":
      "Je comprends que ce scan couvre {count} combinaisons de dates et peut durer plus longtemps.",
    "label.confirmRerun": "Relancer m\u00eame si le m\u00eame scan est en cours.",
    "label.daysRange": "{min}-{max} jours",
    "label.departureWindow": "Fen\u00eatre de d\u00e9part",
    "label.duration": "Dur\u00e9e",
    "label.fastMode": "Mode rapide (ignorer la recherche de vols)",
    "label.fastest": "Plus rapide",
    "label.fewestStops": "Moins d'escales",
    "label.flightHours": "~{hours}h de vol",
    "label.flights": "Vols",
    "label.fromAirports": "Depuis {codes}",
    "label.general": "G\u00e9n\u00e9ral",
    "label.generalCoverage": "Couverture g\u00e9n\u00e9rale",
    "label.haulUnknown": "Type de vol non class\u00e9",
    "label.lodging": "H\u00e9bergement",
    "label.notes": "Notes",
    "label.oneWay": "Aller simple",
    "label.origin": "Origine",
    "label.originShort": "origine",
    "label.other": "Autre",
    "label.pending": "En attente",
    "label.pickDateRange": "Choisissez une plage de dates.",
    "label.pickReturnRange": "Choisissez une plage de dates de retour.",
    "label.price": "Prix",
    "label.returnWindow": "Fen\u00eatre de retour",
    "label.safety": "S\u00e9curit\u00e9 : {level}",
    "label.scoreValue": "Score {score}",
    "label.stops": "Escales",
    "label.stopsCount": {
      one: "{count} escale",
      other: "{count} escales"
    },
    "label.timesUnknown": "Horaires : --",
    "label.timesValue": "Horaires : {value}",
    "label.toAirports": "Vers {codes}",
    "label.topCount": "Top {count}",
    "label.topScore": "Meilleur score",
    "label.totalDaysApprox": {
      one: "~{count} jour",
      other: "~{count} jours"
    },
    "label.travelDays": {
      one: "{count} jour de trajet",
      other: "{count} jours de trajet"
    },
    "label.tripDefault": "trajet",
    "label.tripType.one-way": "aller simple",
    "label.tripType.round-trip": "aller-retour",
    "label.windowIndex": "Fen\u00eatre {index}",
    "language.label": "Langue",
    "legend.closure": "Fermeture",
    "legend.holiday": "Jour f\u00e9ri\u00e9",
    "legend.optimizedLeave": "Cong\u00e9 optimis\u00e9",
    "legend.weekend": "Week-end",
    "map.bestPrice": "Meilleur prix",
    "map.bestRestWindows": "Meilleures fen\u00eatres de repos",
    "map.empty.description":
      "La carte met en avant les hubs d'origine, les clusters de destination et les trajets les plus comp\u00e9titifs selon le prix et la dur\u00e9e.",
    "map.empty.noRoutes": "Aucun trajet \u00e0 afficher pour l'instant.",
    "map.empty.prompt": "Cliquez sur un trajet ou un a\u00e9roport sur la carte.",
    "map.error.missingAirports":
      "Donn\u00e9es d'a\u00e9roports manquantes. Lancez `make map-data` pour r\u00e9g\u00e9n\u00e9rer.",
    "map.flightOptions": "Options de vol",
    "map.legend.destinations": "Destinations",
    "map.legend.origins": "Origines",
    "map.legend.routes": "Trajets",
    "map.minDuration": "Dur\u00e9e min.",
    "map.role": "R\u00f4le",
    "map.role.destination": "Destination",
    "map.role.hub": "Hub",
    "map.role.origin": "Origine",
    "map.routes": "Trajets",
    "map.selectedAirport": "A\u00e9roport s\u00e9lectionn\u00e9",
    "map.selectedRoute": "Itin\u00e9raire s\u00e9lectionn\u00e9",
    "map.stops": "Escales",
    "map.title": "Infos d'itin\u00e9raire",
    "module.oneBadge": "Module 1",
    "module.oneDesc":
      "Entr\u00e9es : ann\u00e9e, jours de cong\u00e9, pays/ville de r\u00e9sidence et repos minimum. Sorties : calendrier optimis\u00e9 et recommandations de destinations.",
    "module.oneTag": "Destinations bas\u00e9es sur les cong\u00e9s",
    "module.oneTitle": "Conseiller : cong\u00e9s optimis\u00e9s \u2192 pays et villes",
    "module.twoBadge": "Module 2",
    "module.twoDesc":
      "Entr\u00e9es : pays/ville d'origine, pays de destination, fen\u00eatres de d\u00e9part et retour. Sorties : top 3 vols par prix, dur\u00e9e, escales et score.",
    "module.twoTag": "Analyses de vols par plage de dates",
    "module.twoTitle": "Stats vols : fen\u00eatres d\u00e9part/retour \u2192 top r\u00e9sultats",
    "multiSelect.empty": "Aucun r\u00e9sultat",
    "multiSelect.emptySelection": "Aucune s\u00e9lection pour l'instant.",
    "multiSelect.placeholder": "Rechercher...",
    "nav.chooseModule": "Choisissez le bon module",
    "nav.missionControl": "Poste de commande",
    "option.haul.all": "Tous les trajets",
    "option.haul.long": "Long-courrier",
    "option.haul.medium": "Moyen-courrier",
    "option.haul.short": "Court-courrier",
    "option.haul.ultra": "Tr\u00e8s long-courrier",
    "option.sort.country": "Trier par pays",
    "option.sort.flightHours": "Trier par dur\u00e9e de vol",
    "option.sort.restAsc": "Trier par jours de repos (asc)",
    "option.sort.restDesc": "Trier par jours de repos",
    "picker.city.empty": "Aucune ville trouv\u00e9e",
    "picker.city.emptyDisabled": "S\u00e9lectionnez d'abord un pays",
    "picker.city.placeholder": "S\u00e9lectionnez une ville de r\u00e9sidence",
    "picker.city.placeholderDisabled": "S\u00e9lectionnez d'abord un pays",
    "picker.city.search": "Rechercher des villes",
    "picker.country.empty": "Aucun pays trouv\u00e9",
    "picker.country.placeholder": "S\u00e9lectionnez un pays",
    "picker.country.search": "Rechercher des pays",
    "picker.destinationCountries.empty": "Aucun pays trouv\u00e9",
    "picker.destinationCountries.emptyState": "Aucun pays de destination s\u00e9lectionn\u00e9.",
    "picker.destinationCountries.placeholder": "S\u00e9lectionnez des pays de destination",
    "picker.destinationCountries.search": "Rechercher des pays",
    "picker.destinationCountries.subtitle": "Recherchez et s\u00e9lectionnez plusieurs pays.",
    "picker.destinationCountries.title": "Pays de destination",
    "picker.homeCity.badge": "Ville",
    "picker.homeCity.subtitle": "Utilis\u00e9e pour trouver les a\u00e9roports proches.",
    "picker.homeCity.title": "Ville de r\u00e9sidence",
    "picker.homeCountry.badge": "R\u00e9sidence",
    "picker.homeCountry.subtitle": "D\u00e9finit le calendrier des jours f\u00e9ri\u00e9s et la base de d\u00e9part.",
    "picker.homeCountry.title": "Pays de r\u00e9sidence",
    "picker.originCity.badge": "Ville",
    "picker.originCity.empty": "Aucune ville trouv\u00e9e",
    "picker.originCity.emptyDisabled": "S\u00e9lectionnez d'abord un pays d'origine",
    "picker.originCity.placeholder": "S\u00e9lectionnez la ville d'origine",
    "picker.originCity.placeholderDisabled": "S\u00e9lectionnez d'abord un pays d'origine",
    "picker.originCity.search": "Rechercher des villes",
    "picker.originCity.subtitle": "Choisissez la ville de d\u00e9part.",
    "picker.originCity.title": "Ville d'origine",
    "picker.originCountry.badge": "Origine",
    "picker.originCountry.empty": "Aucun pays trouv\u00e9",
    "picker.originCountry.placeholder": "S\u00e9lectionnez le pays d'origine",
    "picker.originCountry.search": "Rechercher des pays",
    "picker.originCountry.subtitle": "Choisissez le point de d\u00e9part.",
    "picker.originCountry.title": "Pays d'origine",
    "picker.preferredCities.empty": "Aucune ville trouv\u00e9e",
    "picker.preferredCities.emptyState": "Aucune ville pr\u00e9f\u00e9r\u00e9e s\u00e9lectionn\u00e9e.",
    "picker.preferredCities.placeholder": "S\u00e9lectionnez des villes pr\u00e9f\u00e9r\u00e9es",
    "picker.preferredCities.search": "Rechercher des villes",
    "picker.preferredCities.subtitle": "Recherchez et \u00e9pinglez les villes \u00e0 privil\u00e9gier.",
    "picker.preferredCities.title": "Villes pr\u00e9f\u00e9r\u00e9es",
    "picker.preferredCountries.empty": "Aucun pays trouv\u00e9",
    "picker.preferredCountries.emptyState": "Aucun pays pr\u00e9f\u00e9r\u00e9 s\u00e9lectionn\u00e9.",
    "picker.preferredCountries.placeholder": "S\u00e9lectionnez des pays pr\u00e9f\u00e9r\u00e9s",
    "picker.preferredCountries.search": "Rechercher des pays",
    "picker.preferredCountries.subtitle": "Concentrez les recommandations sur ces pays.",
    "picker.preferredCountries.title": "Pays pr\u00e9f\u00e9r\u00e9s",
    "placeholder.minRestDays": "Min jours de repos",
    "placeholder.searchDestinations": "Rechercher pays, ville ou IATA",
    "plan.dateCombinations": "Combinaisons de dates",
    "plan.departureDates": "Dates de d\u00e9part",
    "plan.description":
      "Nous analysons chaque paire a\u00e9roport d'origine \u00d7 a\u00e9roport de destination pour chaque combinaison de dates. Les r\u00e9sultats sont mis en cache pour \u00e9viter les doublons et le scan s'ex\u00e9cute en parall\u00e8le.",
    "plan.destinationCountries": "Pays de destination",
    "plan.origin": "Origine",
    "plan.pairsCount": {
      one: "{count} paire",
      other: "{count} paires"
    },
    "plan.returnDates": "Dates de retour",
    "plan.selectedCount": {
      one: "{count} s\u00e9lectionn\u00e9",
      other: "{count} s\u00e9lectionn\u00e9s"
    },
    "queue.step.buildMatrix": "Construire la matrice de recherche compl\u00e8te",
    "queue.step.cleanRank": "Nettoyer + classer les r\u00e9sultats",
    "queue.step.loadAirports": "Charger les a\u00e9roports d'origine + destination",
    "queue.step.scanFlights": "Scanner les vols en parall\u00e8le + cache",
    "section.chaslesDesc":
      "Construisez des trajets multi-\u00e9tapes depuis vos pays s\u00e9lectionn\u00e9s. La relation de Chasles garde la cha\u00eene coh\u00e9rente : A\u2192B + B\u2192C = A\u2192C.",
    "section.chaslesItineraries": "Itin\u00e9raires de Chasles",
    "section.chaslesTitle": "Cha\u00eenes d'itin\u00e9raire sugg\u00e9r\u00e9es",
    "section.curatedPlans": "Plans s\u00e9lectionn\u00e9s",
    "section.curatedPlansDesc": "Chaque itin\u00e9raire regroupe sa destination et les meilleures options de voyage.",
    "section.destinationCountries": "Pays de destination",
    "section.destinationFilters": "Filtres de destination",
    "section.destinationFiltersHelp": "S\u00e9lectionnez au moins un pays ou une ville pour lancer le module 1.",
    "section.destinations": "Destinations",
    "section.flightHighlights": "Moments forts des vols",
    "section.flightHighlightsDesc": "Meilleur prix, trajet le plus rapide et meilleurs scores sur les r\u00e9sultats.",
    "section.flightHighlightsTitle": "Meilleures options en un coup d'oeil",
    "section.flightInsights": "Analyses de vols",
    "section.flightJobs": "T\u00e2ches de vols",
    "section.flights": "Vols",
    "section.itineraries": "Itin\u00e9raires",
    "section.leaveSetup": "Configuration des cong\u00e9s",
    "section.leaveSetupDesc":
      "Ce module sugg\u00e8re des destinations en fonction de vos jours de cong\u00e9, de l'ann\u00e9e et de votre lieu de r\u00e9sidence.",
    "section.networkView": "Vue r\u00e9seau",
    "section.optimizedCalendar": "Calendrier optimis\u00e9",
    "section.optimizedCalendarTitle": "Voir chaque jour f\u00e9ri\u00e9 et cong\u00e9 optimis\u00e9",
    "section.originDates": "Origine et dates",
    "section.plannerHighlights": "Points cl\u00e9s du planificateur",
    "section.progressQueue": "Progression et file",
    "section.queueControl": "Contr\u00f4le de la file",
    "section.queueControlDesc":
      "Suivez les scans de vols en arri\u00e8re-plan et t\u00e9l\u00e9chargez les r\u00e9sultats une fois termin\u00e9s.",
    "section.queueNext": "Et ensuite ?",
    "section.queueNextDesc":
      "Lancez un scan d'analyse de vols, puis suivez la progression ici. Vous pouvez annuler une t\u00e2che \u00e0 tout moment et relancer avec d'autres dates ou pays.",
    "section.restPeriodMap": "Carte des p\u00e9riodes de repos",
    "section.routesMap": "Carte des trajets",
    "section.routesMapDesc": "Visualisez les trajets les plus forts et leurs fen\u00eatres de repos.",
    "section.runInsights": "Lancer les analyses",
    "section.runInsightsDesc":
      "Ce module scanne les vols sur vos fen\u00eatres de dates et regroupe les meilleurs prix, trajets les plus rapides et moins d'escales.",
    "section.runOptimizer": "Lancer l'optimiseur",
    "section.runOptimizerDesc":
      "L'optimiseur calcule les meilleures fen\u00eatres de cong\u00e9 et met \u00e0 jour les destinations selon vos filtres.",
    "section.shortlistedPlaces": "Lieux s\u00e9lectionn\u00e9s",
    "section.timeoffIntelligence": "Intelligence des cong\u00e9s",
    "section.topFlightOptions": "Meilleures options de vol",
    "section.topFlightOptionsDesc": "Affichage des meilleures options class\u00e9es sur les destinations.",
    "source.file": "Fichier",
    "source.insightsHint": "Lancez une analyse de vols pour remplir cette vue.",
    "source.insightsLabel": "Analyses",
    "source.latestScanReady": "Dernier scan pr\u00eat",
    "source.loadedLabel": "Charg\u00e9",
    "source.noJobsYet": "Aucune t\u00e2che pour l'instant",
    "source.noScanYet": "Aucun scan pour l'instant",
    "source.none": "Aucune donn\u00e9e charg\u00e9e",
    "source.live": "API en direct",
    "source.optimizerHint": "Lancez l'optimiseur pour g\u00e9n\u00e9rer des r\u00e9sultats.",
    "source.queueHint": "Lancez une analyse de vols pour mettre une t\u00e2che en file.",
    "source.queueLabel": "File",
    "source.trackingJob": "Suivi de la t\u00e2che {id}",
    "stats.acrossWindows": {
      one: "Sur {count} fen\u00eatre",
      other: "Sur {count} fen\u00eatres"
    },
    "stats.bestMonth": "Meilleur mois #{month} \u00b7 {efficiency} repos/CP",
    "stats.compositeRestIndex": "Indice composite de repos",
    "stats.currency": "Devise {currency}",
    "stats.departureWindow": "Fen\u00eatre de d\u00e9part",
    "stats.destinationAirports": "A\u00e9roports de destination",
    "stats.destinations": "Destinations",
    "stats.flightOptions": {
      one: "{count} option de vol",
      other: "{count} options de vol"
    },
    "stats.optimizationScore": "Score d'optimisation",
    "stats.originAirports": "A\u00e9roports d'origine",
    "stats.paidLeaveUsed": "Cong\u00e9s pay\u00e9s utilis\u00e9s",
    "stats.restWindows": {
      one: "{count} fen\u00eatre de repos",
      other: "{count} fen\u00eatres de repos"
    },
    "stats.returnWindow": "Retour {start} - {end}",
    "stats.totalAirports": {
      one: "{count} a\u00e9roport au total",
      other: "{count} a\u00e9roports au total"
    },
    "stats.totalRestDays": "Total de jours de repos",
    "stats.unusedLeave": {
      one: "{count} non utilis\u00e9",
      other: "{count} non utilis\u00e9s"
    },
    "status.activeJobs": "T\u00e2ches actives en cours",
    "status.api.checking": "API en cours de v\u00e9rification",
    "status.api.offline": "API hors ligne",
    "status.api.online": "API en ligne",
    "status.jobId": "ID t\u00e2che {id}",
    "status.jobProgress": "Progression du job",
    "status.lastRun": "Derni\u00e8re ex\u00e9cution {time}",
    "status.lastScan": "Dernier scan {time}",
    "status.latestJobId": "Dernier ID de t\u00e2che {id}",
    "status.noActiveJobs": "Aucune t\u00e2che active",
    "status.queueIdle": "File inactive",
    "status.refreshing": "Actualisation...",
    "status.running": "Ex\u00e9cution...",
    "status.scanning": "Scan en cours...",
    "status.updated": "Mis \u00e0 jour {time}",
    "theme.dark": "Sombre",
    "theme.label": "Th\u00e8me",
    "theme.light": "Clair",
    "tooltip.avgRain": "Pr\u00e9cipitations moyennes : {precip}mm",
    "tooltip.avgRainMonths": "Pr\u00e9cipitations moyennes ({months}) : {precip}mm",
    "tooltip.avgTemp": "Temp\u00e9rature moyenne : {temp}C",
    "tooltip.avgTempMonths": "Temp\u00e9rature moyenne ({months}) : {temp}C",
    "tooltip.safety": "Avis de s\u00e9curit\u00e9"
  }
};

const normalizeLocale = (value?: string | null): Locale => {
  if (!value) return FALLBACK_LOCALE;
  return value.toLowerCase().startsWith("fr") ? "fr" : "en";
};

const getInitialLocale = () => {
  if (typeof window === "undefined") return FALLBACK_LOCALE;
  const stored = window.localStorage.getItem(STORAGE_KEY);
  if (stored === "en" || stored === "fr") return stored;
  return normalizeLocale(window.navigator.language);
};

const formatMessage = (message: string, params?: Record<string, unknown>) => {
  if (!params) return message;
  return message.replace(/\{(\w+)\}/g, (_, key) => String(params[key] ?? ""));
};

const createTranslator = (locale: Locale) => {
  const messages = MESSAGES[locale];
  const fallback = MESSAGES[FALLBACK_LOCALE];
  const pluralRules = new Intl.PluralRules(locale);
  return (key: string, params?: Record<string, unknown>) => {
    const entry = messages[key] ?? fallback[key] ?? key;
    if (typeof entry === "string") {
      return formatMessage(entry, params);
    }
    const count = Number(params?.count ?? 0);
    const category = pluralRules.select(count);
    const template = entry[category] ?? entry.other ?? entry.one ?? key;
    return formatMessage(template, params);
  };
};

type I18nContextValue = {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  t: (key: string, params?: Record<string, unknown>) => string;
};

const I18nContext = createContext<I18nContextValue>({
  locale: FALLBACK_LOCALE,
  setLocale: () => {},
  t: (key) => key
});

export const I18nProvider = ({ children }: { children: React.ReactNode }) => {
  const [locale, setLocale] = useState<Locale>(getInitialLocale);
  const t = useMemo(() => createTranslator(locale), [locale]);

  useEffect(() => {
    if (typeof window !== "undefined") {
      window.localStorage.setItem(STORAGE_KEY, locale);
    }
  }, [locale]);

  const value = useMemo(() => ({ locale, setLocale, t }), [locale, t]);
  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
};

export const useI18n = () => useContext(I18nContext);

export type { Locale };
